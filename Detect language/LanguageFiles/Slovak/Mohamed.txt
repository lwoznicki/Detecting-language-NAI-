Prebivalci Meke so si prizadevali mašèevati za poraz. Da bi ohranili svojo blaginjo, so morali ponovno pridobiti svoj pri Badru izgubljeni ugled.[115] V naslednjih mesecih so iz Meke pošiljali odrede v zasedo, Mohamed pa je vodil odprave proti plemenom, ki so bila zavezniki Meke, in organiziral napad na karavano iz Meke.[116] Abu Sufjan nato zbral vojsko tri tisoè mož in se odpravil v napad na Medino.[111][117]

Izvidnik je kak dan kasneje opozoril Mohameda na bližajoèo se vojsko in na število bojevnikov v njej. Naslednje jutro je na vojnem sestanku muslimanov prišlo do spora glede najprimernejšega odgovora na bližajoèi napad. Mohamed in številne visoke osebe so bile mnenja, da bi bilo varneje, da se borijo v Medini in tako izkoristijo njene moène utrdbe. Argument mlajših muslimanov je bil, da nasprotnik unièuje njihove pridelke in da bo skrivanje za okopi škodilo njihovemu prestižu. Na koncu je Mohamed sprejel mnenje slednjih in muslimanske sile pripravil za boj.[111] Mohamed je tako svojo vojsko odvedel iz mesta do gore Uhud (kjer je stal nasprotnikov tabor), kjer je 23. marca prišlo do bitke pri Uhudu.[118][119] Èeprav je muslimanska vojska dotlej v svojih spopadih vedno uspešna, je prišlo zaradi nediscipliniranosti strateško postavljenih lokostrelcev do poraza muslimanov, ubitih je bilo 75 muslimanov, med njimi Hamza, Mohamedov stric in en od najbolj znanih muèenikov v muslimanskem izroèilu. Nasprotnik muslimanov ni zasledoval, temveè se je vrnil v Meko in razglasil zmago. Verjetno je do tega prišlo, ker je bil Mohamed ranjen in so menili, da je umrl. Ko so med povratkom izvedeli, da je Mohamed živ, se niso obrnili, ker so dobili napaène podatke, da mohamedancem prihajajo nove sile na pomoè.[111] Povsem uspešni tako niso bili, saj jim ni uspelo dokonèno unièiti muslimanov.[120][121] Muslimani so pokopali mrtve in se zveèer vrnili v Medino. Mnogi so se spraševali o razlogih za poraz, Mohamed je nanje odgovoril z verzi,Koran 3,152 po katerih je vzrok za poraz po eni strani kazen za neposlušnost, po drugi strani pa preizkus odloènosti vernikov.[122]

Abu Sufjan je zdaj svoja prizadevanja usmeril v drugi napad na Medino. Pritegnil je podporo nomadskih plemen severno in vzhodno od Medine, pomagal si je s propagando o Mohamedovi šibkosti, obljubljal je plen, spominjal sogovornike na ugled plemena Kurajš in jih podkupoval.[123] Mohamedova politika je sedaj bila, kolikor mu je bilo mogoèe, prepreèiti zavezništva proti njemu. Kadarkoli je prišlo do zaveze proti Medini, je proti plemenom poslal odprave, ki so zavezano unièile.[123] Kadar je Mohamed dobil novice, da se možje zbirajo s sovražnimi nameni proti Medini, je nanje ostro odgovoril.[124] En primer je umor Ka'b ibn al-Ašrafa, poglavarja judovskega rodu Banu Nadir, ki je odšel v Meko in pisal pesmi, ki so v prebivalcih Meke budile žalost, jezo in željo po mašèevanju za bitko pri Badru.[125][126] Mohamed je približno leto kasneje izgnal rod Banu Nadir iz Medine[127] v Sirijo in mu pri tem dovolil, da s seboj vzame nekaj svojega premoženja, ker mu jih v njihovih oporišèih ni uspelo obvladati. Ostali del njihovega premoženja je zahteval Mohamed zase v imenu Boga, ker ni bilo pridobljeno s prelivanjem krvi. Mohamed je veè razliènih arabskih plemen drugega za drugim presenetil z ogromno silo, zaradi èesar so se njegovi sovražniki združili da bi ga skupaj unièili.[128] Mohamedu ni uspelo prepreèiti nastanka konfederacije proti sebi, uspelo pa mu je razširiti svoje sile in prepreèiti številnim plemenom, da bi se pridružila njegovim sovražnikom
S pomoèjo izgnanega Banu Nadirja je vojaški vodja plemena Kurajš Abu Sufjan zbral silo deset tisoè mož. Mohamed je pripravil silo kakih 3.000 mož in se odloèil za obrambo, ki je dotlej v Arabiji niso poznali: na mestih,[128] kjer je Medina ležala odprta za napad konjenice, so muslimani izkopali jarek. Idejo pripisujejo Salmanu Perzijcu, perzijskemu spreobrnjencu v islam. Obleganje Medina se je zaèelo 31. marca 627.[128] in je trajalo dva tedna.[130] Èete Abu Sufjana so utrdbe, na katere so naleteli, presenetile in po neuèinkovitem veètedenskem obleganju se je koalicija odloèila vrniti domov.[128][131] Koran opisuje to bitko v suri Al-Ahzab, v verzih.Koran 33,9 [71] Da bi se uprlo Mohamedu, se je med bitko judovsko pleme Banu Kurajza, naseljeno južno od Medine, zaèelo pogajati s silami iz Meke. Èeprav so imeli odprta ušesa za preprièanje, da bo z Mohamedom kmalu konec, so želeli zagotovila za primer, da ga konfederacija ne uspe unièiti. Do dogovora po dolgotrajnih pogajanjih ni prišlo, delno zaradi Mohamedovih izvidnikov, ki so jih skušali sabotirati.[132] Po umiku koalicijske stranke so muslimani obtožili Banu Qurayza izdajstva in jih 25 dni oblegali v njihovih utrdbah. Banu Qurajza se je navsezadnje predal; kot pravi Ibn Išak, so obglavili vse moške, razen nekaterih, ki so prestopili v islam, ženske in otroke pa so dali v suženjstvo.[128][133][134] Valid N. Arafat in Barakat Ahmad pa pravilnost Ibn Išakove pripovedi izpodbijata.[135] Arafat meni, da so Ibn Išakovi Judovski viri, gledano veè kot 100 let po dogodku, zlili spomin nanj s spomini iz prejšnjih pokolov v judovski zgodovini, ugotavlja, da Ibn Išakov sodobnik Malik Ibn Anas trdi, da Ibn Išak ni zgodovinar, na katerega bi se lahko èlovek zanesel, kasnejši Ibn Hadžar pa ga oznaèuje za prenašalca »èudnih zgodbic«.[136] Ahmad argumentira, da so pobili le del plemena in da so nekatere od borcev samo zasužnjili.[137][138] Arafatovi argumenti za Watta »niso povsem preprièljivi«, Meir J. Kister pa argumentom Arafata in Ahmada nasprotuje[pojasni].[139]

V obleganju Medine je Meka poslala v boj proti muslimanom vse razpoložljive sile. Njen neuspeh je povzroèil znatno izgubo ugleda, njene trgovine s Sirijo pa je bilo konec.[140] Po bitki na jarku so poslali dve odpravi na sever, ki sta se konèali brez boja.[9][128] Ko se je Mohamed vrnil z ene od njih (ali nekaj let prej, kot pravijo druga zgodnja izroèila), so Ajšo, njegovo ženo, obtožili prešuštva. Potem ko je Mohamed javno razglasil novo razodetje, po katerem je Ajša nedolžna in po katerem morajo obtožbe prešuštva podpreti štirje oèividci (sura 24, al-Nur), so jo oprostili vseh obtožb
Leta 632, deset let po selitvi v Medino, se je Mohamed prviè odpravil na pravo islamsko romanje, med njim pa svoje privržence pouèeval o obredih velikega letnega romanja, poznanega kot »Hadž«.[9] Ob koncu svojega romanja je imel na gori Arafat vzhodno od Meke slaven govor, znan kot poslovilni govor. V njem je svojim privržencem svetoval, naj se ne držijo nekaterih pred-islamskih obièajev. Razglasil je, da Arabci niso veè vredni od ne-Arabcev, pa tudi ne-Arabci niso veè od Arabcev. Prav tako belci niso veè vredni od èrncev in èrnci ne od belcev, razen v njih pobožnosti in dobrih delih.[171] Ukinil je vsa stara krvna mašèevanja in spore, povezane z nekdanjim plemenskim sistemom in zahteval, da se vse stare zaobljube razvežejo kot znak rojstva nove islamske skupnosti. Ko je prišel do ranljivosti žensk v svoji družbi, je Mohamed zaprosil svoje moške privržence: »bodite dobri do žena, ki so nemoène jetnice (Avan) v vaši hiši. Vzeli ste si jih iz rok Boga in to zvezo uzakonili z Božjo besedo, zatorej ljudje, spametujte se in poslušajte moje besede ... « Povedal jim je, da imajo pravico krotiti in kaznovati svoje žene, vendar naj jih pri tem vodi dobrota. Lotil se je tudi vprašanja dedovanja in prepovedal lažne zahteve na osnovi oèetovstva ali poslovnega odnosa do pokojnika; svojim privržencem je prepovedal dedièem zapušèati premoženje z oporoko. Poudaril je tudi svetost štirih lunarnih mesecev vsako leto.[172][173][174] Po sunitskem tafsiru je bil med tem dogodkom izreèen naslednji verz Korana: »Danes sem izpopolnil vašo vero in izpolnil Svojo milost do vas in vam za vero izbral islam«.Koran 5,3 [9][175] Po šiitskem tafsiru se ta verz nanaša na imenovanje Alija za Mohamedovega namestnika nekaj dni kasneje, ko so se muslimani vraèali iz Meke v Medino